<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    erros <h1 id="erros"></h1>


    <input type="file" id="input" onchange="processarArquivo(this.files)">


    <script>

        function processarArquivo(p_arquivo) {
            var textoSudoku = "900000001051200030000980000680740000730000908010058670008100000002007090190004060";
            var mapaSudoku = [];
            mapaSudoku[0] = [];
            quebraStringEmMatrizSudoku();
            for (var i = 0; i < mapaSudoku.length; i++) {
                for (var j = 0; j < mapaSudoku[i].length; j++) {
                    if (mapaSudoku[i][j] == 0) {
                        mapaSudoku[i][j] = gerarNumeroAleatorio(1, 9)
                    }
                }
            }


            var quantidadeErros = contaQuantidadeDeErros(mapaSudoku)
            document.getElementById("erros").innerHTML = quantidadeErros
        }




        function quebraStringEmMatrizSudoku() {
            var linha = 0
            for (var i = 0; i < textoSudoku.length; i++) {
                mapaSudoku[linha][mapaSudoku[linha].length] = parseInt(textoSudoku[i])
                if (mapaSudoku[linha].length == 9 && linha < 8) {
                    linha = linha + 1;
                    mapaSudoku[linha] = [];
                }
            }
        }

        function gerarNumeroAleatorio(min, max) {
            return parseInt(Math.random() * (max - min) + min);
        }


        function contaQuantidadeDeErros(p_sudoku) {
            let erros = 0;
            //conta quantidade de erros na linha
            for (var i = 0; i < p_sudoku.length; i++) {
                erros += contaQuantidadeItensRepetidosArray(p_sudoku[i])
            }


            //conta quantidade de erros coluna
            for (var i = 0; i <= 8; i++) {
                coluna = []
                coluna[coluna.length] = p_sudoku[0][i];
                coluna[coluna.length] = p_sudoku[1][i];
                coluna[coluna.length] = p_sudoku[2][i];
                coluna[coluna.length] = p_sudoku[3][i];
                coluna[coluna.length] = p_sudoku[4][i];
                coluna[coluna.length] = p_sudoku[5][i];
                coluna[coluna.length] = p_sudoku[6][i];
                coluna[coluna.length] = p_sudoku[7][i];
                coluna[coluna.length] = p_sudoku[8][i];
                erros += contaQuantidadeItensRepetidosArray(coluna)
            }



            //conta quantidadeErrosQuadrado
            for (var i = 0; i <= 8; i += 3) {
                for (var j = 0; j <= 8; j += 3) {
                    let quadrado = []
                    quadrado[quadrado.length] = p_sudoku[i][j];
                    quadrado[quadrado.length] = p_sudoku[i][j + 1];
                    quadrado[quadrado.length] = p_sudoku[i][j + 2];

                    quadrado[quadrado.length] = p_sudoku[i + 1][j];
                    quadrado[quadrado.length] = p_sudoku[i + 1][j + 1];
                    quadrado[quadrado.length] = p_sudoku[i + 1][j + 2];

                    quadrado[quadrado.length] = p_sudoku[i + 2][j];
                    quadrado[quadrado.length] = p_sudoku[i + 2][j + 1];
                    quadrado[quadrado.length] = p_sudoku[i + 2][j + 2];

                    erros += contaQuantidadeItensRepetidosArray(quadrado)
                }
            }
            return erros
        }

        function contaQuantidadeItensRepetidosArray(p_linha) {
            let erros = 0;
            for (var i = 1; i <= 9; i++) {
                let quantidadeNumeroRepetidos = p_linha.filter(function (a) { return a == i }).length
                if (quantidadeNumeroRepetidos > 0) {
                    erros += quantidadeNumeroRepetidos - 1;
                }
            }

            return erros
        }


        function contaQuantidadeErrosQuadrante() {
            let erros = 0;


            return erros
        }


    </script>
</body>
</html>